<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convocatoria</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 0;
            position: relative;
            background: linear-gradient(to bottom, #fff, #8edcff);
        }

        .principal {
            max-width: calc(100% - 40px);
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        h2 {
            color: #333;
            border-bottom: 1px solid #ccc;
            padding-bottom: 10px;
            margin-bottom: 20px;
            text-align: center;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }

        th {
            background-color: #f2f2f2;
        }

        .player-img {
            max-width: 40px;
            max-height: 40px;
            cursor: pointer;
            display: block;
            margin: 0 auto;
            transition: transform 0.3s ease;
        }

        .player-img:hover {
            transform: scale(1.1);
        }

        .botones {
            text-align: center;
            margin-top: 20px;
        }

        #whatsapp-icon {
            display: inline-block;
            margin-right: 10px;
        }

        #whatsapp-icon button {
            background-color: #25d366;
            color: #fff;
            border: none;
            border-radius: 50%;
            padding: 8px;
            transition: transform 0.3s ease;
        }

        #whatsapp-icon button img {
            width: 24px;
            height: auto;
        }

        #whatsapp-icon button:hover {
            transform: scale(1.1);
        }

        #resetear {
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        #resetear:hover {
            background-color: #0056b3;
        }

        #lugar {
            color: #000000;
            text-decoration: none;
            transition: color 0.5s ease;
        }

        #lugar:hover {
            color: #418cdb;
        }

        @media only screen and (max-width: 600px) {
            body {
                margin: 10px;
            }

            .principal {
                border-radius: 0;
                box-shadow: none;
                padding: 15px;
            }

            table {
                font-size: 14px;
            }

            th, td {
                padding: 8px;
            }

            .player-img {
                max-width: 30px;
                max-height: 30px;
            }
        }
    </style>
</head>

<body>

    <div class="principal">
        <h2>Información del Partido</h2>
        <img src="imagenes/ubl.png" alt="Escudo" style="max-width: 100px; margin: 0 auto 20px; display: block;">
        <p><strong>Fecha:</strong> <span id="fecha-partido" onclick="editarFechaPartido()">22 de abril de 2024</span></p>
        <p><strong>Hora:</strong> <span id="hora-partido" onclick="editarHoraPartido()">19:00</span></p>
        <p><strong>Hora de Quedada:</strong> <span id="hora-quedada" onclick="editarHoraQuedada()">17:30</span></p>
        <p><strong>Lugar de Partido:</strong> <a id="lugar" href="https://www.google.com/maps/dir//C.+Salvador+Allende,+5,+41740+Lebrija,+Sevilla/@36.9160557,-6.1637688,12z/data=!4m8!4m7!1m0!1m5!1m1!1s0xd0decc4d9c7d027:0x16de01e393086eb7!2m2!1d-6.0813678!2d36.9160842?entry=ttu">Estadio Municipal</a></p>
        <p><strong>Equipación:</strong> <span id="equipacion" onclick="editarEquipacion()">Camiseta Roja, Pantalón Azul</span></p>

        <h2>Jugadoras</h2>


        <table>
            <tr>
                <th>Jugadora</th>
                <th>Dorsal</th>
                <th>Convocada</th>
            </tr>
            <!-- Script para generar filas de tabla -->
            <script>
                const jugadores = [
                    { nombre: "CANTERO MAGRIZ, ALEJANDRA", dorsal: 10, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "CASTILLO MARTIN, MARIA", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "DALI DORANTES, NOELIA", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "FALCON CORDERO, VIRGINIA", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "FALCÓN GONZÁLEZ, ROSA", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "FERNÁNDEZ CORDERO, NURIA", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "FERNANDEZ MUÑOZ, DANIELA", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "GALAN MARIN, MARIA", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "GARCIA VILLALBA, CELESTE", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "GUISADO BORNES, DANIELA", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "MORENO BAUTISTA, MARIA DEL CARMEN", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "RODRIGUEZ GONZALEZ, CLAUDIA", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "RUIZ VARGA, JULIA", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "RUIZ VARGAS, ANA", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "TEJERO GONZALEZ, TERESA", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "TRUJILLO RODRIGUEZ, ANGELA ", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "VEGA RUIZ, ALICIA", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "VIDAL SANCHEZ, MARINA", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                    { nombre: "ZAMBRANO PEREIRA, ROCIO", dorsal: 7, imagenes: ["verde.jpg", "rojo.jpg"] },
                ];
                
                /* Para cada jugadora añade el nombre, dorsal y botones */
                jugadores.forEach(jugador => {
                    document.write(`
                        <tr>
                            <td>${jugador.nombre}</td>
                            <td>${jugador.dorsal}</td>
                            <td>
                                <img class="player-img" src="imagenes/${jugador.imagenes[0]}" alt="Imagen 1" onclick="toggleImage(this)">
                                <img class="player-img" src="imagenes/${jugador.imagenes[1]}" alt="Imagen 2" onclick="toggleImage(this)">
                            </td>
                        </tr>
                    `);
                });

                function agregarEventoCalendario() {
                    try {
                        const fechaPartidoTexto = document.querySelector("#fecha-partido").innerText;
                        const fechaPartido = convertirFechaTextoADate(fechaPartidoTexto);
                        const horaQuedada = document.querySelector("#hora-quedada").innerText;

                        fechaPartido.setHours(parseInt(horaQuedada.split(':')[0], 10)); // Establecer la hora de quedada en la fecha del partido
                        fechaPartido.setMinutes(parseInt(horaQuedada.split(':')[1], 10));
                        fechaPartido.setMinutes(fechaPartido.getMinutes() - 60); // Restar 60 minutos para obtener la hora de recordatorio

                        const fechaQuedadaFormato = fechaPartido.toISOString().replace(/-|:|\.\d+/g, ''); // Formatear la fecha
                        const descripcion = 'Hora de quedada para el partido de fútbol en 1h';
                        const ubicacion = 'Estadio Municipal';

                        const userAgent = navigator.userAgent.toLowerCase();
                        if (userAgent.includes('android')) {
                            agregarEventoAndroid(descripcion, fechaQuedadaFormato, ubicacion);
                        } else if (userAgent.includes('iphone') || userAgent.includes('ipad') || userAgent.includes('ipod')) {
                            agregarEventoiPhone(descripcion, fechaQuedadaFormato, ubicacion);
                        } else {
                            agregarEventoGoogle(descripcion, fechaQuedadaFormato, ubicacion);
                        }
                    } catch (error) {
                            console.error('Error al agregar evento al calendario:', error);
                        }
                }

                function convertirFechaTextoADate(fechaTexto) {
                    const partesFecha = fechaTexto.split(' ');
                    const dia = parseInt(partesFecha[0], 10);
                    const mes = partesFecha[2]; // El mes está en texto
                    const año = parseInt(partesFecha[4], 10);

                    // Mapeo de nombres de meses a sus números correspondientes
                    const meses = {
                        "enero": 0,
                        "febrero": 1,
                        "marzo": 2,
                        "abril": 3,
                        "mayo": 4,
                        "junio": 5,
                        "julio": 6,
                        "agosto": 7,
                        "septiembre": 8,
                        "octubre": 9,
                        "noviembre": 10,
                        "diciembre": 11
                    };

                    const mesNumero = meses[mes.toLowerCase()];

                    // Crear objeto Date con los componentes de fecha
                    return new Date(año, mesNumero - 1, dia);
                }

                function agregarEventoAndroid(descripcion, fechaQuedadaFormato, ubicacion) {
                    const enlace = `content://com.android.calendar/events?`
                        + `title=${encodeURIComponent(descripcion)}`
                        + `&eventTimezone=UTC`
                        + `&dtstart=${fechaQuedadaFormato}`
                        + `&dtend=${fechaQuedadaFormato}`
                        + `&eventLocation=${encodeURIComponent(ubicacion)}`;
                    window.location.href = enlace;
                }

                function agregarEventoiPhone(descripcion, fechaQuedadaFormato, ubicacion) {
                    const enlace = `data:text/calendar;charset=utf8,`
                        + `BEGIN:VCALENDAR\n`
                        + `VERSION:2.0\n`
                        + `BEGIN:VEVENT\n`
                        + `DTSTART:${fechaQuedadaFormato}\n`
                        + `DTEND:${fechaQuedadaFormato}\n`
                        + `SUMMARY:${descripcion}\n`
                        + `DESCRIPTION:${descripcion}\n`
                        + `LOCATION:${ubicacion}\n`
                        + `END:VEVENT\n`
                        + `END:VCALENDAR\n`;
                    const enlaceCodificado = encodeURI(enlace);
                    window.location.href = enlaceCodificado; 
                }

                function agregarEventoGoogle(descripcion, fechaQuedadaFormato, ubicacion) {
                    const fechaInicio = fechaQuedadaFormato;
                    const fechaFin = fechaQuedadaFormato;
                    const enlace = `https://calendar.google.com/calendar/render?action=TEMPLATE`
                        + `&text=${encodeURIComponent(descripcion)}`
                        + `&dates=${fechaInicio}/${fechaFin}`
                        + `&details=${encodeURIComponent(descripcion)}`
                        + `&location=${encodeURIComponent(ubicacion)}`;
                    window.open(enlace, '_blank');
                }
            </script>
        </table>

        <!-- Botones -->
        <div class="botones">
            <!-- Botón de WhatsApp -->
            <div id="whatsapp-icon">
                <button onclick="compartirWhatsApp()">
                    <img src="imagenes/whats.png" alt="Compartir en WhatsApp">
                </button>
            </div>

            <!-- Botón de Reset -->
            <button id="resetear" onclick="resetearSeleccion()">Resetear Selección</button>
        </div>

    </div>

    <script>

        function toggleImage(img) {
            const allImages = img.parentNode.querySelectorAll('.player-img');
            allImages.forEach(image => {
                if (image !== img) {
                    image.style.display = 'none';
                }
            });
            img.style.display = 'inline-block';
        }

        // Función para compartir en WhatsApp
        function compartirWhatsApp() {
            const mensaje = encodeURIComponent("Buenas tardes, convocatoria disponible\nhttps://antoniocorser.github.io/Futbol-Tactix/");
            const enlace = `https://api.whatsapp.com/send?text=${mensaje}`;
            window.open(enlace, '_blank');
        }

        // Función para resetear selección
        function resetearSeleccion() {
            const imagenes = document.querySelectorAll('.player-img');
            imagenes.forEach(img => {
                img.style.display = 'block';
            });
        }
       // Función para editar la hora de quedada (solo visible para administradores)
       function editarHoraQuedada() {
            // Verificar si el usuario es administrador
            if (user === 'admin') {
                // Obtener el elemento span
                const spanHoraQuedada = document.getElementById('hora-quedada');

                // Crear un input de tipo texto
                const inputHoraQuedada = document.createElement('input');
                inputHoraQuedada.type = 'text';
                inputHoraQuedada.value = spanHoraQuedada.innerText;

                // Reemplazar el span con el input
                spanHoraQuedada.parentNode.replaceChild(inputHoraQuedada, spanHoraQuedada);

                // Enfocar el input
                inputHoraQuedada.focus();

                // Agregar evento para guardar los cambios al perder el foco
                inputHoraQuedada.addEventListener('blur', function () {
                    // Actualizar el span con el nuevo valor
                    spanHoraQuedada.innerText = inputHoraQuedada.value;
                    // Restaurar el span
                    inputHoraQuedada.parentNode.replaceChild(spanHoraQuedada, inputHoraQuedada);
                });
            }
        }

        // Función para editar el lugar del partido (solo visible para administradores)
        function editarLugar() {
            // Verificar si el usuario es administrador
            if (user === 'admin') {
                // Obtener el elemento span
                const spanLugar = document.getElementById('lugar');

                // Crear un input de tipo texto
                const inputLugar = document.createElement('input');
                inputLugar.type = 'text';
                inputLugar.value = spanLugar.innerText;

                // Reemplazar el span con el input
                spanLugar.parentNode.replaceChild(inputLugar, spanLugar);

                // Enfocar el input
                inputLugar.focus();

                // Agregar evento para guardar los cambios al perder el foco
                inputLugar.addEventListener('blur', function () {
                    // Actualizar el span con el nuevo valor
                    spanLugar.innerText = inputLugar.value;
                    // Restaurar el span
                    inputLugar.parentNode.replaceChild(spanLugar, inputLugar);
                });
            }
        }

        // Función para editar la fecha del partido (solo visible para administradores)
        function editarFechaPartido() {
            // Verificar si el usuario es administrador
            if (user === 'admin') {
                // Obtener el elemento span
                const spanFechaPartido = document.getElementById('fecha-partido');

                // Crear un input de tipo texto
                const inputFechaPartido = document.createElement('input');
                inputFechaPartido.type = 'string';
                inputFechaPartido.value = spanFechaPartido.innerText;

                // Reemplazar el span con el input
                spanFechaPartido.parentNode.replaceChild(inputFechaPartido, spanFechaPartido);

                // Enfocar el input
                inputFechaPartido.focus();

                // Agregar evento para guardar los cambios al perder el foco
                inputFechaPartido.addEventListener('blur', function () {
                    // Actualizar el span con el nuevo valor
                    spanFechaPartido.innerText = inputFechaPartido.value;
                    // Restaurar el span
                    inputFechaPartido.parentNode.replaceChild(spanFechaPartido, inputFechaPartido);
                });
            }
        }

        // Función para editar la hora del partido (solo visible para administradores)
        function editarHoraPartido() {
            // Verificar si el usuario es administrador
            if (user === 'admin') {
                // Obtener el elemento span
                const spanHoraPartido = document.getElementById('hora-partido');

                // Crear un input de tipo texto
                const inputHoraPartido = document.createElement('input');
                inputHoraPartido.type = 'time';
                inputHoraPartido.value = spanHoraPartido.innerText;

                // Reemplazar el span con el input
                spanHoraPartido.parentNode.replaceChild(inputHoraPartido, spanHoraPartido);

                // Enfocar el input
                inputHoraPartido.focus();

                // Agregar evento para guardar los cambios al perder el foco
                inputHoraPartido.addEventListener('blur', function () {
                    // Actualizar el span con el nuevo valor
                    spanHoraPartido.innerText = inputHoraPartido.value;
                    // Restaurar el span
                    inputHoraPartido.parentNode.replaceChild(spanHoraPartido, inputHoraPartido);
                });
            }
        }

        // Función para editar la equipación (solo visible para administradores)
        function editarEquipacion() {
            // Verificar si el usuario es administrador
            if (user === 'admin') {
                // Obtener el elemento span
                const spanEquipacion = document.getElementById('equipacion');

                // Crear un input de tipo texto
                const inputEquipacion = document.createElement('input');
                inputEquipacion.type = 'text';
                inputEquipacion.value = spanEquipacion.innerText;

                // Reemplazar el span con el input
                spanEquipacion.parentNode.replaceChild(inputEquipacion, spanEquipacion);

                // Enfocar el input
                inputEquipacion.focus();

                // Agregar evento para guardar los cambios al perder el foco
                inputEquipacion.addEventListener('blur', function () {
                    // Actualizar el span con el nuevo valor
                    spanEquipacion.innerText = inputEquipacion.value;
                    // Restaurar el span
                    inputEquipacion.parentNode.replaceChild(spanEquipacion, inputEquipacion);
                });
            }
        }

        // Verificar si el usuario ha iniciado sesión y es administrador
        const inicioSesion = 'index.html'; // URL de la página de inicio de sesión
        const urlParams = new URLSearchParams(window.location.search);
        const user = urlParams.get('user');
        if (!(user === 'usuario' || user === 'admin')) {
            // Si "user" no es ni "usuario" ni "admin", redirigir a la página de inicio
            window.location.href = inicioSesion;
        } else if (user === 'usuario') {
            // Ocultar los botones si el usuario no es administrador
            document.querySelector('.botones').style.display = 'none';
            // Habilitar los enlaces para los usuarios normales
            document.querySelectorAll('a').forEach(a => {
                a.removeAttribute('onclick');
            });
        }
    </script>
</body>
</html>
